<div class="d-flex justify-content-center align-items-start bg-dark vh-100 pt-1">
  <div class="floating-card" style="width:100%" >

  <h1 class="display-5 mb-3 heading-gold">Your order</h1>


  <div class="table-responsive">
      <table class="table table-hover table-dark table-bordered align-middle shadow-sm table-sm w-100">

        <thead class="text-center">
        <tr>
          <th class="text-break" style="width: 55%;">Name</th>
          <th style="width: 15%;">Quantity</th>
          <th style="width: 20%;">Price (€)</th>
          <th style="width: 10%;"> </th>
        </tr>
      </thead>

      <tbody  class="text-center text-break">
        <% @order_items.each do |item| %>
          <tr>
            <td><%= item.menu_item&.name || item.wine&.name || item.beverage&.name %></td>
            <td><%= item.quantity %></td>
            <td><%= number_to_currency(item.total, unit: "€") %></td>
            <td class="p-1">
              <%= button_to "DELETE", order_item_path(item),
              method: :delete,
              form: { data: { turbo: false } },
              data: { confirm: "Really???" },
              class: "btn btn-gold btn-sm w-100" %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>

    <div class="d-flex flex-column flex-md-row justify-content-md-between align-items-md-center mt-4 gap-3">
      <div class="d-flex flex-column flex-md-row gap-3 w-100 w-md-auto">
          <%= link_to "Back to Menu", menu_items_path, class: "btn btn-gold w-100 w-md-auto" %>
          <%= link_to "Back to Wine List", wines_path, class: "btn btn-gold w-100 w-md-auto" %>
          <%= link_to "Back to Drinks", beverages_path, class: "btn btn-gold w-100 w-md-auto" %>
      </div>

      <h4 class="text-md-end text-center mb-0">
        <strong>Total:</strong> <%= number_to_currency(@total_price, unit: "€") %>
      </h4>
    </div>

    <div class="d-grid col-12 d-md-flex justify-content-md-end">
      <button id="confirm-order-btn" class="btn btn-gold btn-lg me-md-3 mt-3">
        Confirm Order
      </button>
    </div>

  </div>
 </div>
</div>


<script>
document.addEventListener("DOMContentLoaded", () => {
  const btn = document.getElementById("confirm-order-btn");

  btn.addEventListener("click", () => {

    // SweetAlert
    Swal.fire({
      title: 'Your order is confirmed!',
      html: `
        <p style="font-size:18px; letter-spacing:1px;">
          Get ready — your perfect evening begins now.
        </p>
      `,
      background: "transparent",
      color: "#f8e9c0",
      confirmButtonText: "Cheers!",
      confirmButtonColor: "#d4af37",
      customClass: {
        popup: 'swal-floating-card',
        confirmButton: 'btn-gold'
      }
    });

    launchChampagne();
  });


  function launchChampagne() {
    const container = document.getElementById("champagne-bubbles");
    container.style.display = "block";

    const interval = setInterval(() => {
      createChampagneBubble(container);
    }, 30); // много маленьких пузырьков

    // отключаем
    setTimeout(() => {
      clearInterval(interval);
      setTimeout(() => {
        container.style.display = "none";
        container.innerHTML = "";
      }, 3000);
    }, 3500);
  }


  function createChampagneBubble(container) {
    const bubble = document.createElement("div");
    bubble.classList.add("champagne-bubble");

    const size = Math.random() * 14 + 10;
    bubble.style.width = `${size}px`;
    bubble.style.height = `${size}px`;

    bubble.style.left = `${Math.random() * 100}%`;

    bubble.style.animationDuration = (Math.random() * 2 + 4) + "s";

    container.appendChild(bubble);

    setTimeout(() => bubble.remove(), 7000);
  }
});
</script>
